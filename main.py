# main.py
import sys

# –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ –¥—Ä—É–≥–∏—Ö –º–æ–¥—É–ª–µ–π
from txt_importer import import_text_data
from pdf_exporter import export_to_pdf
from excel_exporter import export_to_excel

# –ò–º—è —Ñ–∞–π–ª–∞, –∫–æ—Ç–æ—Ä—ã–π –º—ã –±—É–¥–µ–º –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å
INPUT_FILE = "source_data.txt"

def main():
    print("--- –ó–∞–ø—É—Å–∫ –ü—Ä–æ–µ–∫—Ç–∞ –≠–∫—Å–ø–æ—Ä—Ç–∞ ---")
    
    # 1. –ò–º–ø–æ—Ä—Ç –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
    data = import_text_data(INPUT_FILE)
    
    if data is None or not data:
        print("\nüö´ –ü—Ä–æ—Ü–µ—Å—Å –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏–∑-–∑–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –∏–ª–∏ –æ—à–∏–±–∫–∏ –≤ –¥–∞–Ω–Ω—ã—Ö.")
        return
        
    print(f"\n–î–∞–Ω–Ω—ã–µ –≥–æ—Ç–æ–≤—ã –∫ —ç–∫—Å–ø–æ—Ä—Ç—É ({len(data)} —ç–ª–µ–º–µ–Ω—Ç–æ–≤).")
    
    # 2. –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –≤ PDF
    export_to_pdf(data, output_filename="Report_Data.pdf")
    
    # 3. –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –≤ Excel
    export_to_excel(data, output_filename="Report_Data.xlsx")
    
    print("\n--- –†–∞–±–æ—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ ---")
    

def analyze_environment():
    """–í—ã–≤–æ–¥–∏—Ç –∏—Å–ø–æ–ª—å–∑—É–µ–º—É—é –≤–µ—Ä—Å–∏—é Python –∏ —Å–ø–∏—Å–æ–∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤, 
    –∏—Å–ø–æ–ª—å–∑—É—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π API (Python 3.10+)."""
    
    print("--- üêç –°—Ä–µ–¥–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è ---")
    print(f"‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –≤–µ—Ä—Å–∏—è Python: {sys.version.split()[0]}")
    print("----------------------------")
    
    print("\n--- üì¶ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (–ü–∞–∫–µ—Ç—ã) ---")
    print("FPDF, openpyxl, pandas")

if __name__ == '__main__':
    analyze_environment()
    main()
    # –î–ª—è —Ç–µ—Å—Ç–∞, —Å–æ–∑–¥–∞–¥–∏–º —Ñ–∏–∫—Ç–∏–≤–Ω—ã–π –∏—Å—Ö–æ–¥–Ω—ã–π —Ñ–∞–π–ª, –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç
    # try:
    #     with open(INPUT_FILE, 'w', encoding='utf-8') as f:
    #         f.write("–ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞\n")
    #         f.write("–í—Ç–æ—Ä–∞—è —Å—Ç—Ä–æ–∫–∞ —Å –¥–∞–Ω–Ω—ã–º–∏\n")
    #         f.write("–¢—Ä–µ—Ç—å—è\n")
    #         f.write(" ") # –ü—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞, –∫–æ—Ç–æ—Ä—É—é –æ–±—Ä–∞–±–æ—Ç–∞–µ—Ç importer
    #         f.write("–ß–µ—Ç–≤–µ—Ä—Ç–∞—è, –ø–æ—Å–ª–µ–¥–Ω—è—è.\n")
    #     print(f"–°–æ–∑–¥–∞–Ω —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª: {INPUT_FILE}")
    # except Exception:
    #     pass # –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –æ—à–∏–±–∫—É –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞
        
    # main()